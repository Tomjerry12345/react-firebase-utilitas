import{initializeApp as e}from"firebase/app";import{getAuth as t,createUserWithEmailAndPassword as r,deleteUser as n,signInWithEmailAndPassword as o,signOut as i}from"firebase/auth";import{getStorage as a,ref as c,uploadBytesResumable as u,getDownloadURL as s}from"firebase/storage";import{getFirestore as f,addDoc as h,collection as m,serverTimestamp as d,doc as l,setDoc as v,query as g,orderBy as p,limit as P,onSnapshot as y,getDocs as j,where as b,updateDoc as D,deleteDoc as E}from"firebase/firestore";function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w.apply(this,arguments)}var S=function(S){var O=e(S),C=t(O),U=a(O),M=f(O),A=function(e,t){return E(l(M,e,t))},Q=function(e,t){return o(C,e,t)},T=function(){return new Promise(function(e,t){C.onAuthStateChanged(function(t){e(t||null)})})};return{createUser:function(e,t){try{return Promise.resolve(r(C,e,t))}catch(e){return Promise.reject(e)}},deleteUserServices:function(e,t,r,o){return new Promise(function(i,a){try{return Promise.resolve(Q(t,r)).then(function(){C.onAuthStateChanged(function(t){null!==t&&n(t).then(function(){A(e,o),i(!0)}).catch(function(e){console.error(e),i(!1)})})})}catch(e){return Promise.reject(e)}})},uploadImage:function(e){return new Promise(function(t,r){var n=c(U,"images/"+e.name),o=u(n,e);o.on("state_changed",function(e){console.log("Upload is "+e.bytesTransferred/e.totalBytes*100+"% done")},function(e){r(e)},function(){s(o.snapshot.ref).then(function(e){t(e)})})})},addData:function(e,t){return h(m(M,e),w({},t,{timestamp:d()}))},addDataSpecifict:function(e,t){return h(e,w({},t,{timestamp:d()}))},loginWithEmail:Q,getDataQuery:function(e,t,r){try{var n=m(M,e),o=g(n,b(t,"==",r));return Promise.resolve(j(o)).then(function(e){var t=[];return e.forEach(function(e){t.push(w({},e.data(),{id:e.id}))}),t})}catch(e){return Promise.reject(e)}},getDataQuery2:function(e,t,r,n,o){try{var i=m(M,e),a=g(i,b(t,"==",r),b(n,"==",o));return Promise.resolve(j(a)).then(function(e){var t=[];return e.forEach(function(e){t.push(w({},e.data(),{id:e.id}))}),t})}catch(e){return Promise.reject(e)}},getCurrentUser:T,updateDocX:function(e,t,r){return D(l(M,e,t),r)},deletDoc:A,getDataCollection:function(e){try{var t=m(M,e);return Promise.resolve(j(t)).then(function(e){var t=[];return e.forEach(function(e){t.push(w({},e.data(),{id:e.id}))}),t})}catch(e){return Promise.reject(e)}},getNotif:function(e,t){try{return Promise.resolve(T()).then(function(t){var r=m(M,e),n=g(r,b("email","==",t.email),b("new","==",!0));y(n,function(e){var t=[];e.forEach(function(e){t.push(w({id:e.id},e.data()))}),console.log(t)})})}catch(e){return Promise.reject(e)}},getDataSpecifict:function(e){try{return Promise.resolve(j(e)).then(function(e){var t=[];return e.forEach(function(e){t.push(w({},e.data(),{id:e.id}))}),t})}catch(e){return Promise.reject(e)}},sendMessage:function(e,t,r){var n=m(M,"chat",e,"message",t,"message"),o=l(M,"chat",e,"message",t);h(n,r),v(o,{generate:(new Date).getTime()})},getMessage:function(e,t,r){var n=m(M,"chat",t,"message",r,"message"),o=g(n,p("timestamp"),P(50)),i=y(o,function(t){var r=[];t.forEach(function(e){r.push(w({},e.data(),{id:e.id}))}),e(r)});return i},getGrupMessage:function(e){try{return Promise.resolve(function(t,r){try{var n=(o=m(M,"chat",e,"message"),Promise.resolve(j(o)).then(function(e){var t=[];return e.forEach(function(e){try{return t.push(e.id),Promise.resolve()}catch(e){return Promise.reject(e)}}),t}))}catch(e){return r(e)}var o;return n&&n.then?n.then(void 0,r):n}(0,function(e){alert(e)}))}catch(e){return Promise.reject(e)}},onSignOut:function(){try{return Promise.resolve(i(C))}catch(e){return Promise.reject(e)}}}};export{S as default};
//# sourceMappingURL=index.module.js.map
