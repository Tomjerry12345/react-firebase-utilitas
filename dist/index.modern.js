import{initializeApp as a}from"firebase/app";import{getAuth as e,createUserWithEmailAndPassword as t,deleteUser as s,signInWithEmailAndPassword as n,signOut as r}from"firebase/auth";import{getStorage as o,ref as i,uploadBytesResumable as c,getDownloadURL as d}from"firebase/storage";import{getFirestore as h,addDoc as u,collection as g,serverTimestamp as m,doc as p,setDoc as f,query as l,orderBy as y,limit as w,onSnapshot as b,getDocs as D,where as E,updateDoc as S,deleteDoc as O}from"firebase/firestore";function v(){return v=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(a[s]=t[s])}return a},v.apply(this,arguments)}const C=C=>{const P=a(C),U=e(P),j=o(P),M=h(P),A=(a,e)=>O(p(M,a,e)),Q=(a,e)=>n(U,a,e),T=()=>new Promise((a,e)=>{U.onAuthStateChanged(function(e){a(e||null)})});return{createUser:async(a,e)=>await t(U,a,e),deleteUserServices:(a,e,t,n)=>new Promise(async(r,o)=>{await Q(e,t),U.onAuthStateChanged(function(e){null!==e&&s(e).then(()=>{A(a,n),r(!0)}).catch(a=>{console.error(a),r(!1)})})}),uploadImage:a=>new Promise((e,t)=>{const s=i(j,`images/${a.name}`),n=c(s,a);n.on("state_changed",a=>{console.log("Upload is "+a.bytesTransferred/a.totalBytes*100+"% done")},a=>{t(a)},()=>{d(n.snapshot.ref).then(a=>{e(a)})})}),addData:(a,e)=>u(g(M,a),v({},e,{timestamp:m()})),addDataSpecifict:(a,e)=>u(a,v({},e,{timestamp:m()})),loginWithEmail:Q,getDataQuery:async(a,e,t)=>{const s=g(M,a),n=l(s,E(e,"==",t)),r=await D(n),o=[];return r.forEach(a=>{o.push(v({},a.data(),{id:a.id}))}),o},getDataQuery2:async(a,e,t,s,n)=>{const r=g(M,a),o=l(r,E(e,"==",t),E(s,"==",n)),i=await D(o),c=[];return i.forEach(a=>{c.push(v({},a.data(),{id:a.id}))}),c},getCurrentUser:T,updateDocX:(a,e,t)=>S(p(M,a,e),t),deletDoc:A,getDataCollection:async a=>{const e=g(M,a),t=await D(e),s=[];return t.forEach(a=>{s.push(v({},a.data(),{id:a.id}))}),s},getNotif:async(a,e)=>{const t=await T(),s=g(M,a),n=l(s,E("email","==",t.email),E("new","==",!0));b(n,a=>{const e=[];a.forEach(a=>{e.push(v({id:a.id},a.data()))}),console.log(e)})},getDataSpecifict:async a=>{const e=a,t=await D(e),s=[];return t.forEach(a=>{s.push(v({},a.data(),{id:a.id}))}),s},sendMessage:(a,e,t)=>{const s=g(M,"chat",a,"message",e,"message"),n=p(M,"chat",a,"message",e);u(s,t),f(n,{generate:(new Date).getTime()})},getMessage:(a,e,t)=>{const s=g(M,"chat",e,"message",t,"message"),n=l(s,y("timestamp"),w(50)),r=b(n,e=>{let t=[];e.forEach(a=>{t.push(v({},a.data(),{id:a.id}))}),a(t)});return r},getGrupMessage:async a=>{try{const e=g(M,"chat",a,"message"),t=await D(e),s=[];return t.forEach(async a=>{s.push(a.id)}),s}catch(a){alert(a)}},onSignOut:async()=>await r(U)}};export{C as default};
//# sourceMappingURL=index.modern.js.map
